<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Kinetis SDK Demo Applications User&#39;s Guide: GPIO I2C Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="fs_logo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Kinetis SDK Demo Applications User&#39;s Guide
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Freescale Semiconductor, Inc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Demos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__gpio__i2c__main.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GPIO I2C Demo</div>  </div>
</div><!--header-->
<div class="contents">
<p>This demo application demonstrates the GPIO I2C demo.</p>
<h1><a class="anchor" id="Ovw"></a>
Overview</h1>
<p>This demo application is a simulator which uses the GPIO to simulate the I2C protocol and control the MMA8451 or the FXOS8700CQ microcontrollers on the board. The UART console shows values received from the MMA8451 or the FXOS8700CQ.</p>
<h1><a class="anchor" id="SP"></a>
Supported Platforms</h1>
<p>These Freescale Freedom development platforms and Tower System modules are supported by the KSDK GPIO I2C demo.</p>
<ul>
<li>FRDM-K22F</li>
<li>FRDM-K64F</li>
<li>TWR-K22F120M</li>
<li>TWR-K64F120M</li>
<li>TWR-KV31F120M</li>
</ul>
<h1><a class="anchor" id="GS"></a>
Getting Started</h1>
<h2><a class="anchor" id="PtD"></a>
Prepare the Demo</h2>
<ol type="1">
<li>Connect a USB cable between the PC host and the OpenSDA USB port on the board.</li>
<li>Open a serial terminal with these settings:<ul>
<li>115200 baud rate</li>
<li>8 data bits</li>
<li>No parity</li>
<li>One stop bit</li>
<li>No flow control</li>
</ul>
</li>
<li>Download the program to the target board.</li>
<li>Either press the reset button on your board or launch the debugger in your IDE to begin running the demo.</li>
</ol>
<p>For more detailed instructions, see a Kinetis SDK User's Guide for your board.</p>
<h2>Hardware configuration</h2>
<p>These pins are used to connect to the accelerometer on the board:</p>
<div> <table class="doxtable">
<tr>
<th rowspan="1">Platform </th><th rowspan="1">SCL </th><th rowspan="1">SDA  </th></tr>
<tr>
<th rowspan="1">FRDM-K22F </th><td align="center">PTB2 </td><td align="center">PTB3  </td></tr>
<tr>
<th rowspan="1">FRDM-K64F </th><td align="center">PTE24 </td><td align="center">PTE25  </td></tr>
<tr>
<th rowspan="1">TWR-K22F120M </th><td align="center">PTC10 </td><td align="center">PTC11  </td></tr>
<tr>
<th rowspan="1">TWR-K64F120M </th><td align="center">PTC10 </td><td align="center">PTC11  </td></tr>
<tr>
<th rowspan="1">TWR-KV31F120M </th><td align="center">PTD2 </td><td align="center">PTD3  </td></tr>
</table>
</div><h2><a class="anchor" id="RtD"></a>
Run the demo</h2>
<ol type="1">
<li>Download the program to a target broad.</li>
<li>Connect the USB cable to the PC host and open a serial terminal configured as shown in the table.</li>
<li>For the MMA8451, the UART outputs values in the X, Y, and Z direction, received from the MMA8451. <div class="fragment"><div class="line">== Accelerometer Test ==</div>
<div class="line"></div>
<div class="line">Reading acceleration data...</div>
<div class="line">x=4, y=1, z=1</div>
</div><!-- fragment --></li>
<li>For the FXOS8700CQ, UART provides output values in the X, Y, Z direction and magnetism. <div class="fragment"><div class="line">== Accelerometer Test ==</div>
<div class="line"></div>
<div class="line">Jan  8 2014    15:12:40</div>
<div class="line">Initializing FXOS...</div>
<div class="line">Resetting FXOS...</div>
<div class="line">Reading acceleration data...</div>
<div class="line">xAcc = 28, yAcc = -100, zAcc = 2075, xMag = 89, yMag = -55, zMag = 336</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="Cust"></a>
Customization Options</h2>
<p>Parameters are available and can be configured to meet other requirements.</p>
<h3>SCL and SDA configurations</h3>
<p>The BOARD_I2C_GPIO_SCL and BOARD_I2C_GPIO_SDA macros define which GPIO pins are used to emulate I2C pins for the MMA8451 or FXOS8700CQ I2C interface. <br/>
 These macros can be configured in mcu-sdk\boards\&lt;board_name&gt;\board.h </p>
<div class="fragment"><div class="line"><span class="preprocessor">#define BOARD_I2C_GPIO_SCL              GPIO_MAKE_PIN(HW_GPIOE, 24)</span></div>
<div class="line"><span class="preprocessor">#define BOARD_I2C_GPIO_SDA              GPIO_MAKE_PIN(HW_GPIOE, 25)</span></div>
</div><!-- fragment --><h3>Baudrate configuration</h3>
<p>To get the correct I2C baudrate, use an oscilloscope to look at the baudrate waveform. <br/>
 A delay is used in this demo application for a correct baudrate. This is defined in the mcu-sdk\boards\&lt;board_name&gt;\board.h file.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define BOARD_I2C_DELAY \</span></div>
<div class="line"><span class="preprocessor">do \</span></div>
<div class="line"><span class="preprocessor">{ \</span></div>
<div class="line"><span class="preprocessor">    int32_t i; \</span></div>
<div class="line"><span class="preprocessor">      for (i = 0; i &lt; 500; i++) \</span></div>
<div class="line"><span class="preprocessor">    { \</span></div>
<div class="line"><span class="preprocessor">         __asm(&quot;nop&quot;); \</span></div>
<div class="line"><span class="preprocessor">    } \</span></div>
<div class="line"><span class="preprocessor">} while (0)</span></div>
</div><!-- fragment --><p>Important things to remember:</p>
<ul>
<li>For a higher baudrate, reduce the delay time and loop count.</li>
<li>For a lower baudrate, increase the delay time and loop count.</li>
<li>Keep in mind code execution time.</li>
<li>Use an oscilloscope to get the correct baudrate waveform.</li>
<li>There is no delay in code execution in this demo application. Therefore, this might be the highest baudrate.</li>
<li>See the I2C protocol and the MMA8451 and the FXOS microcontroller details for more information. </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
    <li class="footer">Sat Jul 26 2014 &copy; 2014 Freescale Semiconductor, Inc. All rights reserved. 
    </li>
  </ul>
</div>
</body>
</html>
